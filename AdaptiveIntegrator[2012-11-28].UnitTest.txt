########## Test of AdaptiveIntegrator routines at 2012-11-28 7:20:24 PM
Using Module AdaptiveIntegrator[2012-11-28]

All test cases integrate from x = 1.0 to x = 2.0
and should give an integral of exactly 1.0

====== Test case 1 ======
Integrating 6 * (x - 1) * (2 - x)  quadratic
Req.Err  Returned          Rel.Error  Calls  Deep Min. Seg. Begin   Min. Seg. End
-------  ----------------- --------- ------ ---- ----------------- -----------------
      1                  1       0.0      5    0                 1                 2
    0.1                  1       0.0      5    0                 1                 2
   0.01                  1       0.0      5    0                 1                 2
  0.001                  1       0.0      5    0                 1                 2

====== Test case 2 ======
Integrating (x - 1)^2 * (10 - 4 * x)  cubic
Req.Err  Returned          Rel.Error  Calls  Deep Min. Seg. Begin   Min. Seg. End
-------  ----------------- --------- ------ ---- ----------------- -----------------
      1                  1       0.0      5    0                 1                 2
    0.1                  1       0.0      5    0                 1                 2
   0.01                  1       0.0      5    0                 1                 2
  0.001                  1       0.0      5    0                 1                 2

====== Test case 3 ======
Integrating 30 * ((x - 1) * (2 - x))^2  quartic
Req.Err  Returned          Rel.Error  Calls  Deep Min. Seg. Begin   Min. Seg. End
-------  ----------------- --------- ------ ---- ----------------- -----------------
      1           1.015625  0.015625      5    0                 1                 2
    0.1       1.0009765625 9.7656E-4      9    1                 1               1.5
   0.01       1.0009765625 9.7656E-4      9    1                 1               1.5
  0.001   1.00006103515625 6.1035E-5     17    2                 1              1.25
 0.0001   1.00000381469727 3.8147E-6     33    3                 1             1.125
0.00001   1.00000381469727 3.8147E-6     33    3                 1             1.125
1.00E-6   1.00000023841858 2.3842E-7     65    4                 1            1.0625
1.00E-7   1.00000001490116 1.4901E-8    129    5                 1           1.03125
1.00E-8   1.00000001490116 1.4901E-8    129    5                 1           1.03125
1.00E-9   1.00000000093132 9.313E-10    257    6                 1          1.015625
1.0E-10   1.00000000005821 5.821E-11    513    7                 1         1.0078125
1.0E-11   1.00000000005821 5.821E-11    513    7                 1         1.0078125
1.0E-12   1.00000000000364 3.638E-12   1025    8                 1        1.00390625
1.0E-13   1.00000000000023 2.274E-13   2049    9                 1       1.001953125
1.0E-14   1.00000000000023 2.274E-13   2049    9                 1       1.001953125
1.0E-15   1.00000000000008 7.572E-14   4097   10                 1      1.0009765625
1.0E-16   1.00000000000008 7.572E-14   4097   10                 1      1.0009765625

====== Test case 4 ======
Integrating 0.5 * Pi * Sin(Pi * (x - 1))  half sine
Req.Err  Returned          Rel.Error  Calls  Deep Min. Seg. Begin   Min. Seg. End
-------  ----------------- --------- ------ ---- ----------------- -----------------
      1   1.00227987749221 2.2799E-3      5    0                 1                 2
    0.1   1.00227987749221 2.2799E-3      5    0                 1                 2
   0.01   1.00013458497419 1.3458E-4      9    1                 1               1.5
  0.001   1.00000829552397 8.2955E-6     17    2                 1              1.25
 0.0001   1.00000829552397 8.2955E-6     17    2                 1              1.25
0.00001   1.00000051668471 5.1668E-7     33    3                 1             1.125
1.00E-6   1.00000017414825 1.7415E-7     49    3              1.25            1.3125
1.00E-7     1.000000032265 3.2265E-8     65    4                 1            1.0625
1.00E-8   1.00000000259735 2.5974E-9    121    4            1.0625           1.09375
1.00E-9   1.00000000067961 6.796E-10    193    5              1.25          1.265625
1.0E-10    1.0000000001351 1.351E-10    249    5           1.03125          1.046875
1.0E-11   1.00000000001015 1.015E-11    481    6            1.0625         1.0703125
1.0E-12   1.00000000000253 2.533E-12    777    7         1.2421875        1.24609375
1.0E-13   1.00000000000052 5.167E-13   1001    7         1.0234375        1.02734375
1.0E-14   1.00000000000005 4.641E-14   1905    8         1.0703125       1.072265625
1.0E-15   1.00000000000004 3.531E-14   3057    9              1.25      1.2509765625
1.0E-16   1.00000000000004 3.531E-14   3673    9         1.1015625      1.1025390625

====== Test case 5 ======
Integrating Exp(-0.5 * ((x - Pi / 2) / 0.01)^2 / (0.01 * Sqr(2 * Pi))  narrow peak
Req.Err  Returned          Rel.Error  Calls  Deep Min. Seg. Begin   Min. Seg. End
-------  ----------------- --------- ------ ---- ----------------- -----------------
      1  2.7726608921986N6 -.9999972      9    1                 1               1.5
    0.1   1.00020163396707 2.0163E-4     41    4               1.5           1.53125
   0.01   1.00037571577242 3.7572E-4     61    4          1.484375         1.4921875
  0.001   1.00004711690446 4.7117E-5     81    5         1.4921875        1.49609375
 0.0001   1.00001394664907 1.3947E-5     97    5        1.49609375       1.498046875
0.00001   1.00000110630904 1.1063E-6    145    6       1.498046875      1.4990234375
1.00E-6   1.00000028788851 2.8789E-7    205    6        1.49609375      1.4970703125
1.00E-7   1.00000007028786 7.0288E-8    293    7      1.4970703125     1.49755859375
1.00E-8   1.00000000317275 3.1727E-9    481    7     1.49853515625    1.498779296875
1.00E-9   1.00000000062024 6.202E-10    749    8      1.4951171875    1.495361328125
1.0E-10   1.00000000003545 3.545E-11   1117    9      1.4970703125   1.4971923828125
1.0E-11   1.00000000001577 1.577E-11   1785   10    1.498779296875  1.49884033203125
1.0E-12   1.00000000000243 2.435E-12   2841   10    1.495361328125  1.49542236328125
1.0E-13   1.00000000000015 1.492E-13   4305   11  1.49700927734375  1.49703979492188
1.0E-14   1.00000000000006 6.062E-14   7001   12  1.49874877929688  1.49876403808594
1.0E-15  0.999999999999993 -7.11E-15  11241   12    1.495361328125  1.49537658691406
1.0E-16  0.999999999999993 -7.22E-15  12921   13  1.49928283691406  1.49929046630859

====== Test case 6 ======
Integrating x^4 - 5.2 + 3 * Sin(34 * Pi * (x - 1))  oscillatory
Req.Err  Returned          Rel.Error  Calls  Deep Min. Seg. Begin   Min. Seg. End
-------  ----------------- --------- ------ ---- ----------------- -----------------
      1   1.00052083333333 5.2083E-4      5    0                 1                 2
    0.1   1.00052083333333 5.2083E-4      5    0                 1                 2
   0.01   1.00052083333333 5.2083E-4      5    0                 1                 2
  0.001   1.00001224318892 1.2243E-5    265    6          1.390625         1.3984375
 0.0001   1.00000318798762 3.1880E-6    429    7                 1         1.0078125
0.00001  0.999999798781174 -2.012E-7    645    7              1.25        1.25390625
1.00E-6  0.999999996207417 -3.793E-9   1069    8             1.375       1.376953125
1.00E-7  0.999999990754104 -9.246E-9   1713    8         1.0078125       1.009765625
1.00E-8  0.999999998381289 -1.619E-9   2565    9              1.25      1.2509765625
1.00E-9  0.999999999892459 -1.08E-10   4277    9             1.375     1.37548828125
1.0E-10  0.999999999997503 -2.50E-12   6841   10      1.0068359375     1.00732421875
1.0E-11  0.999999999996558 -3.44E-12  10201   11              1.25    1.250244140625
1.0E-12  0.999999999999777 -2.23E-13  16973   11             1.375   1.3751220703125
1.0E-13  0.999999999999951 -4.88E-14  27045   12     1.00732421875   1.0074462890625
1.0E-14   0.99999999999998 -1.97E-14  40701   13              1.25  1.25006103515625
1.0E-15                  1 2.442E-15  67805   13             1.375  1.37503051757813
1.0E-16                  1 2.442E-15  76473   14              1.25  1.25003051757813

====== Test case 7 ======
Integrating x^4 - 5.2 + 3 * Sin(34 * Pi * (x - 1))  oscillatory with dxMax = -500
Req.Err  Returned          Rel.Error  Calls  Deep Min. Seg. Begin   Min. Seg. End
-------  ----------------- --------- ------ ---- ----------------- -----------------
      1   1.00000000000194 1.940E-12    513    7                 1         1.0078125
    0.1   1.00000000000194 1.940E-12    513    7                 1         1.0078125
   0.01   1.00000000000194 1.940E-12    513    7                 1         1.0078125
  0.001   1.00000000000194 1.940E-12    513    7                 1         1.0078125
 0.0001   1.00000000000194 1.940E-12    513    7                 1         1.0078125
0.00001  0.999999798780265 -2.012E-7    653    7              1.25        1.25390625
1.00E-6  0.999999996207417 -3.793E-9   1069    8             1.375       1.376953125
1.00E-7  0.999999990754104 -9.246E-9   1713    8         1.0078125       1.009765625
1.00E-8  0.999999998381289 -1.619E-9   2565    9              1.25      1.2509765625
1.00E-9  0.999999999892459 -1.08E-10   4277    9             1.375     1.37548828125
1.0E-10  0.999999999997503 -2.50E-12   6841   10      1.0068359375     1.00732421875
1.0E-11  0.999999999996558 -3.44E-12  10201   11              1.25    1.250244140625
1.0E-12  0.999999999999777 -2.23E-13  16973   11             1.375   1.3751220703125
1.0E-13  0.999999999999951 -4.88E-14  27045   12     1.00732421875   1.0074462890625
1.0E-14   0.99999999999998 -1.97E-14  40701   13              1.25  1.25006103515625
1.0E-15                  1 2.442E-15  67805   13             1.375  1.37503051757813
1.0E-16                  1 2.442E-15  76473   14              1.25  1.25003051757813

====== Test case 8 ======
Integrating IIf(x > 0.5 * Pi, 0#, 1# / (0.5 * Pi - 1#))  step
Req.Err  Returned          Rel.Error  Calls  Deep Min. Seg. Begin   Min. Seg. End
-------  ----------------- --------- ------ ---- ----------------- -----------------
      1   1.02196406309906 2.1964E-2      5    0                 1                 2
    0.1  0.948966630020559 -5.103E-2      9    1                 1               1.5
   0.01  0.994590025694624 -5.410E-3     21    3               1.5            1.5625
  0.001  0.999722657707956 -2.773E-4     37    5         1.5703125        1.57421875
 0.0001  0.999936517375179 -6.348E-5     49    8         1.5703125     1.57080078125
0.00001  0.999998893111452 -1.107E-6     61    9   1.5706787109375  1.57073974609375
1.00E-6    1.0000005638901 5.6389E-7     77    9  1.57079315185547  1.57079696655273
1.00E-7  0.999999989559941 -1.044E-8     97   11    1.570796251297  1.57079637050629
1.00E-8   1.00000000043741 4.374E-10    109   13  1.57079631090164   1.5707963258028
1.00E-9   1.00000000016547 1.655E-10    121   15   1.5707963258028  1.57079632766545
1.0E-10  0.999999999961517 -3.85E-11    129   16  1.57079632673413  1.57079632719979
1.0E-11   1.00000000000401 4.007E-12    141   19  1.57079632673413  1.57079632679233
1.0E-12   1.00000000000002 2.331E-14    161   23  1.57079632679233  1.57079632679415
1.0E-13   1.00000000000006 5.662E-14    173   24  1.57079632679461  1.57079632679483
1.0E-14  0.999999999999999 -1.33E-15    181   25  1.57079632679483  1.57079632679489
1.0E-15                  1 -1.11E-16    201   28  1.57079632679489   1.5707963267949
1.0E-16                  1 -1.11E-16    201   28  1.57079632679489   1.5707963267949

====== Test case 9 ======
Integrating C / Sqr(x - 1 + eps)  nearly singular  eps = 0.000000001
where C = 0.5 / ((Sqr(1 + eps) - Sqr(eps))) = 0.500015811638301
Req.Err  Returned          Rel.Error  Calls  Deep Min. Seg. Begin   Min. Seg. End
-------  ----------------- --------- ------ ---- ----------------- -----------------
      1   1318.34268195276 1317.3427      5    0                 1                 2
    0.1    1.0780360244823 7.8036E-2     61   14                 1  1.00006103515625
   0.01   1.00925479046053 9.2548E-3     73   17                 1  1.00000762939453
  0.001   1.00048065484719 4.8065E-4     89   21                 1  1.00000047683716
 0.0001   1.00005678276383 5.6783E-5    105   24                 1  1.00000005960464
0.00001   1.00000727271011 7.2727E-6    141   26                 1  1.00000001490116
1.00E-6   1.00000083766356 8.3766E-7    213   28                 1  1.00000000372529
1.00E-7   1.00000014409615 1.4410E-7    321   29                 1  1.00000000186265
1.00E-8   1.00000001986097 1.9861E-8    517   30                 1  1.00000000093132
1.00E-9   1.00000000317936 3.1794E-9    813   31                 1  1.00000000046566
1.0E-10   1.00000000051966 5.197E-10   1277   32                 1  1.00000000023283
1.0E-11   1.00000000008175 8.175E-11   2021   33                 1  1.00000000011642
1.0E-12   1.00000000001259 1.259E-11   3237   33                 1  1.00000000011642
1.0E-13   1.00000000000215 2.145E-12   5109   34                 1  1.00000000005821
1.0E-14   1.00000000000046 4.559E-13   8085   35                 1   1.0000000000291
1.0E-15   1.00000000000021 2.127E-13  12897   35                 1   1.0000000000291
1.0E-16   1.00000000000021 2.127E-13  15121   36                 1  1.00000000001455

====== Test case 10 ======
Integrating A / (1 + B * Sin(C * 2 * Pi * x))  spikes
where B = 0.999  C = 11  A = Sqr(1 - B^2) = 4.47101778122163E-02
Req.Err  Returned          Rel.Error  Calls  Deep Min. Seg. Begin   Min. Seg. End
-------  ----------------- --------- ------ ---- ----------------- -----------------
      1   14.9257514206901 13.925751      5    0                 1                 2
    0.1   0.27843801331246 -.7215620     57    6              1.25         1.2578125
   0.01   0.24601560618075 -.7539844    117    8              1.25       1.251953125
  0.001  0.483841585806492 -.5161584    285   10              1.25     1.25048828125
 0.0001  0.775734866534646 -.2242651    545   10       1.431640625    1.431884765625
0.00001   1.00003510814661 3.5108E-5   1045   11     1.06787109375    1.068115234375
1.00E-6   1.00000519446455 5.1945E-6   1569   12              1.25   1.2501220703125
1.00E-7   1.00000068162085 6.8162E-7   2517   13              1.25  1.25006103515625
1.00E-8   1.00000007512198 7.5122E-8   4065   13    1.068115234375  1.06817626953125
1.00E-9   1.00000001653448 1.6534E-8   6325   14              1.25  1.25003051757813
1.0E-10   1.00000000278923 2.7892E-9  10009   15              1.25  1.25001525878906
1.0E-11   1.00000000042111 4.211E-10  16249   15  1.06805419921875  1.06806945800781
1.0E-12   1.00000000006663 6.663E-11  25117   16              1.25  1.25000762939453
1.0E-13   1.00000000001086 1.086E-11  39813   17              1.25  1.25000381469727
1.0E-14   1.00000000000162 1.620E-12  64677   17  1.06806182861328  1.06806564331055
1.0E-15   1.00000000000045 4.510E-13  99825   18              1.25  1.25000190734863
1.0E-16   1.00000000000045 4.510E-13 120889   18   1.0681037902832  1.06810569763184

====== Test case 11 ======
Integrating 1 / Abs(x - 1 - 1 / Pi)  singularity not at binary fraction
Req.Err  Returned          Rel.Error  Calls  Deep Min. Seg. Begin   Min. Seg. End
-------  ----------------- --------- ------ ---- ----------------- -----------------
      1   6.95323935506442 5.9532394      5    0                 1                 2
    0.1   6.70860800144874 5.7086080      9    1                 1               1.5
   0.01   65.8519117018499 64.851912    205   23  1.31830988618367  1.31830988618373
== Error #952  Description:
Segment too small (integrand singularity?):
  length = 2.22044604925031E-16 starts at x = 1.31830988618379
xBeg = 1 xEnd = 2 which = -11  invoked = 148
Problem in AdaptiveIntegrator[2012-11-28].aiIntegrate
== getAiResultText(errNum):
Segment too small (integrand singularity?):
  length = 2.22044604925031E-16 starts at x = 1.31830988618379
Sub-segment tolerance met only from 1.0 to 1.31830988618379

====== Test case 12 ======
Integrating 1 / Abs(x - 1.53125)  singularity at binary fraction
Req.Err  Returned          Rel.Error  Calls  Deep Min. Seg. Begin   Min. Seg. End
-------  ----------------- --------- ------ ---- ----------------- -----------------
      1   7.25078494490259 6.2507849      9    1                 1               1.5
    0.1   6.97910542616425 5.9791054     13    2                 1              1.25
== Error #11  Description:
Division by zero
x = 1.53125  which = -12  calls = 19
Problem in AdaptiveIntegrator[2012-11-28].aiIntegrand
xBeg = 1 xEnd = 2 which = -12  invoked = 151
Called by AdaptiveIntegrator[2012-11-28].aiIntegrate
== getAiResultText(errNum):
VB error code 11 = Division by zero
Sub-segment tolerance met only from 1.0 to 1.5

aiIntegrate was called 151 times
aiIntegrand was called 1,031,439 times
Unit tests complete in 1.203 seconds
~~~~~~~~~~ AdaptiveIntegrator unit tests ~~~~~~~~ end of file ~~~~~~~~~~
